/**************************************************************************
 * (C)Copyright IDfusion, LLC. All rights reserved.
 *
 * Please refer to the file named Documentation/COPYRIGHT in the top of
 * the source tree for copyright and licensing information.
 **************************************************************************/

#include <stdio.h>
#include <string.h>
#include <stdarg.h>
#include <stdbool.h>

#include <sgx_tcrypto.h>

#include "test-naaaim-interface.h"

#include <HurdLib.h>
#include <Buffer.h>
#include <String.h>

#include "SHA256.h"
#include "RandomBuffer.h"
#include "Curve25519.h"
#include "SHA256_hmac.h"
#include "AES256_cbc.h"
#include "Base64.h"
#include "RSAkey.h"
#include "SEALkey.h"
#include "SEALEDblob.h"
#include "X509cert.h"
#include "Prompt.h"


static uint8_t Key[1675] = {
	0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, \
	0x49, 0x4e, 0x20, 0x52, 0x53, 0x41, 0x20, 0x50, \
	0x52, 0x49, 0x56, 0x41, 0x54, 0x45, 0x20, 0x4b, \
	0x45, 0x59, 0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x0a, \
	0x4d, 0x49, 0x49, 0x45, 0x6f, 0x77, 0x49, 0x42, \
	0x41, 0x41, 0x4b, 0x43, 0x41, 0x51, 0x45, 0x41, \
	0x76, 0x57, 0x6b, 0x55, 0x77, 0x6f, 0x6c, 0x58, \
	0x79, 0x4e, 0x37, 0x6a, 0x45, 0x33, 0x54, 0x42, \
	0x6a, 0x5a, 0x37, 0x67, 0x73, 0x45, 0x74, 0x31, \
	0x51, 0x71, 0x2f, 0x39, 0x78, 0x66, 0x73, 0x4a, \
	0x46, 0x5a, 0x38, 0x4f, 0x38, 0x54, 0x42, 0x4b, \
	0x47, 0x54, 0x6f, 0x4f, 0x78, 0x78, 0x59, 0x38, \
	0x0a, 0x79, 0x6d, 0x46, 0x48, 0x64, 0x6e, 0x74, \
	0x47, 0x44, 0x59, 0x53, 0x41, 0x31, 0x4d, 0x49, \
	0x64, 0x69, 0x33, 0x76, 0x58, 0x78, 0x79, 0x6f, \
	0x2b, 0x63, 0x62, 0x39, 0x52, 0x4f, 0x58, 0x4f, \
	0x71, 0x7a, 0x72, 0x77, 0x73, 0x70, 0x77, 0x38, \
	0x39, 0x4a, 0x34, 0x45, 0x2b, 0x6e, 0x48, 0x36, \
	0x5a, 0x55, 0x65, 0x74, 0x6a, 0x77, 0x36, 0x71, \
	0x46, 0x48, 0x57, 0x63, 0x47, 0x54, 0x77, 0x4b, \
	0x31, 0x0a, 0x4f, 0x6c, 0x46, 0x75, 0x53, 0x43, \
	0x6c, 0x46, 0x37, 0x4e, 0x72, 0x73, 0x65, 0x50, \
	0x4b, 0x53, 0x37, 0x46, 0x69, 0x4a, 0x56, 0x35, \
	0x54, 0x62, 0x64, 0x49, 0x7a, 0x36, 0x6c, 0x62, \
	0x35, 0x33, 0x35, 0x63, 0x59, 0x48, 0x73, 0x4d, \
	0x36, 0x4d, 0x67, 0x78, 0x30, 0x72, 0x68, 0x7a, \
	0x66, 0x64, 0x35, 0x42, 0x62, 0x2f, 0x6e, 0x51, \
	0x55, 0x6d, 0x64, 0x33, 0x6d, 0x37, 0x70, 0x37, \
	0x46, 0x50, 0x0a, 0x73, 0x74, 0x49, 0x6f, 0x6d, \
	0x4d, 0x4f, 0x79, 0x58, 0x55, 0x78, 0x78, 0x75, \
	0x65, 0x2f, 0x74, 0x34, 0x54, 0x47, 0x64, 0x66, \
	0x42, 0x6f, 0x67, 0x71, 0x6c, 0x7a, 0x49, 0x63, \
	0x4b, 0x71, 0x79, 0x67, 0x6e, 0x36, 0x57, 0x77, \
	0x31, 0x55, 0x4d, 0x38, 0x66, 0x4b, 0x41, 0x6a, \
	0x64, 0x46, 0x6a, 0x4d, 0x55, 0x44, 0x6a, 0x54, \
	0x5a, 0x67, 0x45, 0x6c, 0x2b, 0x4b, 0x69, 0x74, \
	0x62, 0x2f, 0x65, 0x0a, 0x41, 0x6b, 0x74, 0x31, \
	0x69, 0x6a, 0x70, 0x41, 0x36, 0x70, 0x6f, 0x31, \
	0x78, 0x6b, 0x59, 0x70, 0x67, 0x65, 0x52, 0x4a, \
	0x61, 0x6a, 0x55, 0x4f, 0x54, 0x38, 0x33, 0x43, \
	0x78, 0x63, 0x44, 0x6a, 0x6e, 0x56, 0x74, 0x38, \
	0x64, 0x2f, 0x48, 0x5a, 0x31, 0x4e, 0x7a, 0x76, \
	0x4b, 0x36, 0x50, 0x4c, 0x4f, 0x6c, 0x4a, 0x50, \
	0x65, 0x72, 0x44, 0x34, 0x42, 0x6a, 0x31, 0x74, \
	0x56, 0x61, 0x43, 0x35, 0x0a, 0x79, 0x4a, 0x6b, \
	0x57, 0x46, 0x6a, 0x69, 0x75, 0x4b, 0x4f, 0x59, \
	0x6b, 0x56, 0x32, 0x48, 0x35, 0x6c, 0x46, 0x4a, \
	0x2f, 0x4c, 0x62, 0x6d, 0x4d, 0x4d, 0x74, 0x7a, \
	0x58, 0x4e, 0x6c, 0x58, 0x47, 0x59, 0x6f, 0x7a, \
	0x44, 0x39, 0x51, 0x49, 0x44, 0x41, 0x51, 0x41, \
	0x42, 0x41, 0x6f, 0x49, 0x42, 0x41, 0x47, 0x2b, \
	0x6d, 0x79, 0x62, 0x34, 0x44, 0x42, 0x2b, 0x51, \
	0x34, 0x76, 0x74, 0x4a, 0x78, 0x0a, 0x4f, 0x4d, \
	0x63, 0x71, 0x71, 0x48, 0x68, 0x44, 0x67, 0x74, \
	0x50, 0x55, 0x75, 0x6c, 0x74, 0x43, 0x4a, 0x35, \
	0x43, 0x2f, 0x4f, 0x69, 0x65, 0x69, 0x74, 0x34, \
	0x73, 0x33, 0x56, 0x67, 0x36, 0x31, 0x5a, 0x52, \
	0x42, 0x48, 0x56, 0x38, 0x44, 0x58, 0x32, 0x65, \
	0x75, 0x4e, 0x2b, 0x41, 0x4e, 0x79, 0x69, 0x63, \
	0x66, 0x33, 0x4d, 0x4c, 0x4d, 0x4f, 0x69, 0x39, \
	0x43, 0x78, 0x58, 0x6b, 0x66, 0x6e, 0x0a, 0x6a, \
	0x77, 0x42, 0x65, 0x6e, 0x46, 0x4f, 0x39, 0x2f, \
	0x2b, 0x61, 0x52, 0x6f, 0x54, 0x37, 0x4f, 0x77, \
	0x63, 0x49, 0x77, 0x5a, 0x35, 0x61, 0x6e, 0x70, \
	0x65, 0x41, 0x33, 0x49, 0x74, 0x6a, 0x67, 0x56, \
	0x38, 0x51, 0x51, 0x7a, 0x46, 0x6c, 0x74, 0x4f, \
	0x76, 0x4c, 0x72, 0x2b, 0x67, 0x6b, 0x78, 0x74, \
	0x4c, 0x6e, 0x74, 0x56, 0x73, 0x68, 0x78, 0x7a, \
	0x77, 0x74, 0x64, 0x4c, 0x7a, 0x6d, 0x6d, 0x0a, \
	0x46, 0x54, 0x63, 0x31, 0x44, 0x4d, 0x4f, 0x45, \
	0x66, 0x66, 0x2b, 0x72, 0x36, 0x6b, 0x54, 0x44, \
	0x41, 0x65, 0x47, 0x36, 0x54, 0x4f, 0x4e, 0x61, \
	0x62, 0x64, 0x70, 0x75, 0x75, 0x39, 0x62, 0x58, \
	0x55, 0x37, 0x4f, 0x74, 0x30, 0x73, 0x6a, 0x54, \
	0x56, 0x6e, 0x77, 0x6e, 0x4a, 0x42, 0x79, 0x78, \
	0x59, 0x6f, 0x31, 0x57, 0x73, 0x2f, 0x35, 0x48, \
	0x48, 0x6a, 0x44, 0x67, 0x6a, 0x2f, 0x57, 0x46, \
	0x0a, 0x75, 0x41, 0x63, 0x6f, 0x33, 0x34, 0x79, \
	0x55, 0x68, 0x31, 0x58, 0x4c, 0x49, 0x47, 0x36, \
	0x50, 0x48, 0x72, 0x75, 0x69, 0x73, 0x4e, 0x59, \
	0x4c, 0x7a, 0x48, 0x73, 0x72, 0x70, 0x6a, 0x4c, \
	0x73, 0x68, 0x35, 0x43, 0x5a, 0x54, 0x44, 0x53, \
	0x69, 0x4e, 0x73, 0x4a, 0x63, 0x62, 0x75, 0x33, \
	0x35, 0x4b, 0x2b, 0x42, 0x55, 0x73, 0x4f, 0x49, \
	0x58, 0x32, 0x4e, 0x54, 0x54, 0x41, 0x77, 0x51, \
	0x31, 0x0a, 0x52, 0x54, 0x4c, 0x63, 0x70, 0x62, \
	0x50, 0x63, 0x35, 0x6f, 0x48, 0x6d, 0x2f, 0x50, \
	0x38, 0x6b, 0x70, 0x4c, 0x39, 0x78, 0x30, 0x79, \
	0x56, 0x31, 0x43, 0x4e, 0x63, 0x46, 0x41, 0x44, \
	0x6b, 0x67, 0x53, 0x43, 0x58, 0x53, 0x63, 0x4d, \
	0x34, 0x59, 0x38, 0x64, 0x47, 0x42, 0x47, 0x61, \
	0x4a, 0x6b, 0x42, 0x31, 0x54, 0x51, 0x4d, 0x69, \
	0x43, 0x6d, 0x33, 0x6d, 0x4b, 0x4c, 0x62, 0x4e, \
	0x76, 0x77, 0x0a, 0x47, 0x42, 0x39, 0x71, 0x74, \
	0x51, 0x45, 0x43, 0x67, 0x59, 0x45, 0x41, 0x36, \
	0x4b, 0x30, 0x73, 0x50, 0x64, 0x49, 0x6a, 0x7a, \
	0x6a, 0x49, 0x77, 0x58, 0x59, 0x31, 0x75, 0x47, \
	0x6f, 0x50, 0x6f, 0x48, 0x34, 0x35, 0x65, 0x36, \
	0x39, 0x2b, 0x49, 0x6a, 0x59, 0x65, 0x64, 0x78, \
	0x5a, 0x72, 0x63, 0x66, 0x48, 0x4f, 0x38, 0x61, \
	0x71, 0x46, 0x2f, 0x51, 0x49, 0x54, 0x34, 0x6d, \
	0x5a, 0x62, 0x66, 0x0a, 0x70, 0x6d, 0x79, 0x71, \
	0x65, 0x73, 0x78, 0x49, 0x67, 0x71, 0x4d, 0x30, \
	0x33, 0x6e, 0x46, 0x4d, 0x37, 0x46, 0x63, 0x76, \
	0x2b, 0x6b, 0x4d, 0x43, 0x51, 0x53, 0x5a, 0x76, \
	0x73, 0x56, 0x67, 0x76, 0x51, 0x64, 0x43, 0x4a, \
	0x74, 0x6b, 0x61, 0x51, 0x37, 0x52, 0x57, 0x6a, \
	0x54, 0x30, 0x62, 0x77, 0x71, 0x37, 0x6c, 0x76, \
	0x66, 0x34, 0x47, 0x70, 0x64, 0x49, 0x34, 0x44, \
	0x4f, 0x35, 0x65, 0x48, 0x0a, 0x38, 0x54, 0x46, \
	0x42, 0x69, 0x41, 0x78, 0x56, 0x6f, 0x31, 0x2f, \
	0x2f, 0x6c, 0x66, 0x37, 0x51, 0x76, 0x31, 0x43, \
	0x43, 0x73, 0x50, 0x51, 0x45, 0x49, 0x35, 0x78, \
	0x68, 0x51, 0x69, 0x6e, 0x33, 0x4b, 0x58, 0x34, \
	0x58, 0x42, 0x32, 0x69, 0x54, 0x44, 0x66, 0x6a, \
	0x6a, 0x4f, 0x39, 0x37, 0x6b, 0x39, 0x62, 0x36, \
	0x65, 0x2b, 0x33, 0x6b, 0x43, 0x67, 0x59, 0x45, \
	0x41, 0x30, 0x47, 0x57, 0x6a, 0x0a, 0x59, 0x46, \
	0x36, 0x38, 0x61, 0x57, 0x6d, 0x4f, 0x67, 0x76, \
	0x31, 0x65, 0x6b, 0x39, 0x55, 0x6a, 0x70, 0x49, \
	0x37, 0x46, 0x76, 0x2f, 0x48, 0x7a, 0x75, 0x61, \
	0x30, 0x65, 0x55, 0x71, 0x39, 0x2b, 0x45, 0x6c, \
	0x6a, 0x34, 0x68, 0x50, 0x49, 0x6d, 0x50, 0x78, \
	0x50, 0x59, 0x54, 0x62, 0x37, 0x70, 0x6c, 0x32, \
	0x41, 0x65, 0x54, 0x64, 0x57, 0x74, 0x4e, 0x38, \
	0x77, 0x66, 0x65, 0x48, 0x66, 0x61, 0x0a, 0x67, \
	0x39, 0x67, 0x70, 0x71, 0x44, 0x38, 0x35, 0x61, \
	0x47, 0x2f, 0x4e, 0x47, 0x59, 0x6f, 0x76, 0x69, \
	0x7a, 0x70, 0x6a, 0x68, 0x71, 0x4c, 0x65, 0x47, \
	0x30, 0x2f, 0x53, 0x6e, 0x41, 0x34, 0x32, 0x4e, \
	0x4d, 0x4c, 0x39, 0x44, 0x66, 0x6e, 0x52, 0x51, \
	0x6e, 0x53, 0x43, 0x33, 0x35, 0x64, 0x39, 0x6f, \
	0x6f, 0x36, 0x43, 0x51, 0x30, 0x59, 0x35, 0x68, \
	0x51, 0x58, 0x2f, 0x57, 0x41, 0x4f, 0x68, 0x0a, \
	0x73, 0x49, 0x64, 0x49, 0x2b, 0x6f, 0x56, 0x54, \
	0x2b, 0x6e, 0x38, 0x49, 0x7a, 0x2b, 0x72, 0x30, \
	0x55, 0x54, 0x69, 0x57, 0x66, 0x34, 0x36, 0x7a, \
	0x43, 0x58, 0x74, 0x38, 0x74, 0x6b, 0x62, 0x44, \
	0x41, 0x75, 0x5a, 0x6a, 0x63, 0x56, 0x30, 0x43, \
	0x67, 0x59, 0x45, 0x41, 0x72, 0x79, 0x42, 0x41, \
	0x62, 0x31, 0x74, 0x75, 0x4a, 0x62, 0x46, 0x79, \
	0x34, 0x38, 0x63, 0x69, 0x65, 0x77, 0x53, 0x54, \
	0x0a, 0x50, 0x73, 0x55, 0x61, 0x76, 0x72, 0x41, \
	0x6c, 0x69, 0x46, 0x6a, 0x74, 0x73, 0x43, 0x43, \
	0x4b, 0x47, 0x59, 0x58, 0x47, 0x35, 0x2f, 0x38, \
	0x62, 0x31, 0x30, 0x54, 0x2b, 0x46, 0x43, 0x51, \
	0x52, 0x75, 0x36, 0x4b, 0x49, 0x67, 0x68, 0x71, \
	0x6c, 0x37, 0x4f, 0x58, 0x49, 0x55, 0x6a, 0x43, \
	0x32, 0x39, 0x42, 0x2f, 0x2f, 0x64, 0x58, 0x37, \
	0x67, 0x41, 0x49, 0x64, 0x63, 0x67, 0x2f, 0x2f, \
	0x61, 0x0a, 0x75, 0x63, 0x2b, 0x72, 0x42, 0x79, \
	0x31, 0x2f, 0x77, 0x57, 0x4b, 0x4b, 0x34, 0x34, \
	0x32, 0x43, 0x63, 0x63, 0x34, 0x46, 0x6c, 0x4e, \
	0x50, 0x54, 0x35, 0x6d, 0x31, 0x4a, 0x45, 0x35, \
	0x35, 0x4f, 0x37, 0x49, 0x50, 0x6c, 0x54, 0x65, \
	0x2f, 0x79, 0x75, 0x52, 0x2f, 0x31, 0x4d, 0x45, \
	0x46, 0x31, 0x66, 0x72, 0x6d, 0x72, 0x56, 0x47, \
	0x4b, 0x6c, 0x68, 0x75, 0x51, 0x5a, 0x39, 0x41, \
	0x48, 0x41, 0x0a, 0x44, 0x56, 0x50, 0x68, 0x49, \
	0x32, 0x74, 0x62, 0x57, 0x36, 0x58, 0x62, 0x36, \
	0x6d, 0x45, 0x75, 0x74, 0x61, 0x51, 0x2b, 0x35, \
	0x77, 0x6b, 0x43, 0x67, 0x59, 0x42, 0x70, 0x76, \
	0x47, 0x67, 0x63, 0x71, 0x58, 0x53, 0x6e, 0x64, \
	0x32, 0x74, 0x62, 0x67, 0x76, 0x72, 0x4e, 0x76, \
	0x30, 0x4d, 0x4b, 0x5a, 0x33, 0x5a, 0x6d, 0x59, \
	0x58, 0x6a, 0x73, 0x4b, 0x4b, 0x35, 0x4e, 0x2f, \
	0x63, 0x54, 0x56, 0x0a, 0x77, 0x6c, 0x61, 0x31, \
	0x2f, 0x62, 0x62, 0x79, 0x49, 0x6a, 0x75, 0x4a, \
	0x6c, 0x75, 0x67, 0x6d, 0x61, 0x68, 0x70, 0x32, \
	0x47, 0x34, 0x68, 0x37, 0x32, 0x78, 0x48, 0x4d, \
	0x71, 0x65, 0x4d, 0x78, 0x4b, 0x69, 0x68, 0x59, \
	0x75, 0x56, 0x75, 0x44, 0x5a, 0x64, 0x61, 0x47, \
	0x73, 0x74, 0x70, 0x55, 0x70, 0x68, 0x65, 0x42, \
	0x5a, 0x48, 0x6d, 0x56, 0x47, 0x66, 0x63, 0x65, \
	0x50, 0x77, 0x65, 0x35, 0x0a, 0x31, 0x59, 0x56, \
	0x58, 0x35, 0x66, 0x30, 0x4b, 0x33, 0x74, 0x72, \
	0x59, 0x58, 0x36, 0x44, 0x62, 0x4c, 0x62, 0x74, \
	0x69, 0x4c, 0x75, 0x74, 0x59, 0x56, 0x79, 0x61, \
	0x72, 0x6e, 0x59, 0x77, 0x59, 0x61, 0x55, 0x76, \
	0x5a, 0x38, 0x48, 0x51, 0x66, 0x6b, 0x50, 0x30, \
	0x44, 0x6f, 0x59, 0x36, 0x38, 0x39, 0x78, 0x31, \
	0x46, 0x4d, 0x7a, 0x34, 0x62, 0x2f, 0x59, 0x2f, \
	0x56, 0x58, 0x43, 0x6e, 0x74, 0x0a, 0x2b, 0x72, \
	0x39, 0x52, 0x38, 0x51, 0x4b, 0x42, 0x67, 0x44, \
	0x69, 0x79, 0x4d, 0x30, 0x72, 0x75, 0x39, 0x31, \
	0x5a, 0x57, 0x54, 0x57, 0x50, 0x33, 0x2b, 0x36, \
	0x45, 0x51, 0x2f, 0x63, 0x33, 0x49, 0x38, 0x41, \
	0x69, 0x67, 0x68, 0x35, 0x49, 0x52, 0x58, 0x33, \
	0x5a, 0x50, 0x5a, 0x5a, 0x31, 0x76, 0x54, 0x32, \
	0x2b, 0x50, 0x2b, 0x59, 0x45, 0x36, 0x31, 0x66, \
	0x78, 0x51, 0x73, 0x6c, 0x6c, 0x70, 0x0a, 0x73, \
	0x4c, 0x74, 0x41, 0x4a, 0x47, 0x48, 0x66, 0x53, \
	0x43, 0x41, 0x34, 0x66, 0x46, 0x57, 0x4f, 0x73, \
	0x70, 0x59, 0x6e, 0x4f, 0x77, 0x7a, 0x41, 0x2f, \
	0x72, 0x62, 0x49, 0x39, 0x6a, 0x39, 0x79, 0x59, \
	0x38, 0x61, 0x4e, 0x63, 0x32, 0x43, 0x4c, 0x54, \
	0x6e, 0x4a, 0x70, 0x6c, 0x70, 0x66, 0x7a, 0x79, \
	0x5a, 0x69, 0x76, 0x55, 0x56, 0x78, 0x77, 0x52, \
	0x7a, 0x63, 0x6f, 0x45, 0x69, 0x65, 0x6b, 0x0a, \
	0x62, 0x68, 0x67, 0x35, 0x63, 0x32, 0x62, 0x39, \
	0x4b, 0x64, 0x65, 0x6b, 0x78, 0x49, 0x57, 0x6a, \
	0x4a, 0x41, 0x61, 0x64, 0x57, 0x75, 0x35, 0x41, \
	0x79, 0x61, 0x65, 0x45, 0x42, 0x74, 0x6c, 0x6f, \
	0x66, 0x6c, 0x45, 0x63, 0x6f, 0x53, 0x46, 0x30, \
	0x48, 0x5a, 0x51, 0x75, 0x78, 0x4e, 0x39, 0x62, \
	0x4c, 0x4d, 0x77, 0x46, 0x0a, 0x2d, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x45, 0x4e, 0x44, 0x20, 0x52, 0x53, \
	0x41, 0x20, 0x50, 0x52, 0x49, 0x56, 0x41, 0x54, \
	0x45, 0x20, 0x4b, 0x45, 0x59, 0x2d, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x0a
};


static uint8_t PublicKey[451] = {
	0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, \
	0x49, 0x4e, 0x20, 0x50, 0x55, 0x42, 0x4c, 0x49, \
	0x43, 0x20, 0x4b, 0x45, 0x59, 0x2d, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x0a, 0x4d, 0x49, 0x49, 0x42, 0x49, \
	0x6a, 0x41, 0x4e, 0x42, 0x67, 0x6b, 0x71, 0x68, \
	0x6b, 0x69, 0x47, 0x39, 0x77, 0x30, 0x42, 0x41, \
	0x51, 0x45, 0x46, 0x41, 0x41, 0x4f, 0x43, 0x41, \
	0x51, 0x38, 0x41, 0x4d, 0x49, 0x49, 0x42, 0x43, \
	0x67, 0x4b, 0x43, 0x41, 0x51, 0x45, 0x41, 0x76, \
	0x57, 0x6b, 0x55, 0x77, 0x6f, 0x6c, 0x58, 0x79, \
	0x4e, 0x37, 0x6a, 0x45, 0x33, 0x54, 0x42, 0x6a, \
	0x5a, 0x37, 0x67, 0x0a, 0x73, 0x45, 0x74, 0x31, \
	0x51, 0x71, 0x2f, 0x39, 0x78, 0x66, 0x73, 0x4a, \
	0x46, 0x5a, 0x38, 0x4f, 0x38, 0x54, 0x42, 0x4b, \
	0x47, 0x54, 0x6f, 0x4f, 0x78, 0x78, 0x59, 0x38, \
	0x79, 0x6d, 0x46, 0x48, 0x64, 0x6e, 0x74, 0x47, \
	0x44, 0x59, 0x53, 0x41, 0x31, 0x4d, 0x49, 0x64, \
	0x69, 0x33, 0x76, 0x58, 0x78, 0x79, 0x6f, 0x2b, \
	0x63, 0x62, 0x39, 0x52, 0x4f, 0x58, 0x4f, 0x71, \
	0x7a, 0x72, 0x77, 0x73, 0x0a, 0x70, 0x77, 0x38, \
	0x39, 0x4a, 0x34, 0x45, 0x2b, 0x6e, 0x48, 0x36, \
	0x5a, 0x55, 0x65, 0x74, 0x6a, 0x77, 0x36, 0x71, \
	0x46, 0x48, 0x57, 0x63, 0x47, 0x54, 0x77, 0x4b, \
	0x31, 0x4f, 0x6c, 0x46, 0x75, 0x53, 0x43, 0x6c, \
	0x46, 0x37, 0x4e, 0x72, 0x73, 0x65, 0x50, 0x4b, \
	0x53, 0x37, 0x46, 0x69, 0x4a, 0x56, 0x35, 0x54, \
	0x62, 0x64, 0x49, 0x7a, 0x36, 0x6c, 0x62, 0x35, \
	0x33, 0x35, 0x63, 0x59, 0x48, 0x0a, 0x73, 0x4d, \
	0x36, 0x4d, 0x67, 0x78, 0x30, 0x72, 0x68, 0x7a, \
	0x66, 0x64, 0x35, 0x42, 0x62, 0x2f, 0x6e, 0x51, \
	0x55, 0x6d, 0x64, 0x33, 0x6d, 0x37, 0x70, 0x37, \
	0x46, 0x50, 0x73, 0x74, 0x49, 0x6f, 0x6d, 0x4d, \
	0x4f, 0x79, 0x58, 0x55, 0x78, 0x78, 0x75, 0x65, \
	0x2f, 0x74, 0x34, 0x54, 0x47, 0x64, 0x66, 0x42, \
	0x6f, 0x67, 0x71, 0x6c, 0x7a, 0x49, 0x63, 0x4b, \
	0x71, 0x79, 0x67, 0x6e, 0x36, 0x57, 0x0a, 0x77, \
	0x31, 0x55, 0x4d, 0x38, 0x66, 0x4b, 0x41, 0x6a, \
	0x64, 0x46, 0x6a, 0x4d, 0x55, 0x44, 0x6a, 0x54, \
	0x5a, 0x67, 0x45, 0x6c, 0x2b, 0x4b, 0x69, 0x74, \
	0x62, 0x2f, 0x65, 0x41, 0x6b, 0x74, 0x31, 0x69, \
	0x6a, 0x70, 0x41, 0x36, 0x70, 0x6f, 0x31, 0x78, \
	0x6b, 0x59, 0x70, 0x67, 0x65, 0x52, 0x4a, 0x61, \
	0x6a, 0x55, 0x4f, 0x54, 0x38, 0x33, 0x43, 0x78, \
	0x63, 0x44, 0x6a, 0x6e, 0x56, 0x74, 0x38, 0x0a, \
	0x64, 0x2f, 0x48, 0x5a, 0x31, 0x4e, 0x7a, 0x76, \
	0x4b, 0x36, 0x50, 0x4c, 0x4f, 0x6c, 0x4a, 0x50, \
	0x65, 0x72, 0x44, 0x34, 0x42, 0x6a, 0x31, 0x74, \
	0x56, 0x61, 0x43, 0x35, 0x79, 0x4a, 0x6b, 0x57, \
	0x46, 0x6a, 0x69, 0x75, 0x4b, 0x4f, 0x59, 0x6b, \
	0x56, 0x32, 0x48, 0x35, 0x6c, 0x46, 0x4a, 0x2f, \
	0x4c, 0x62, 0x6d, 0x4d, 0x4d, 0x74, 0x7a, 0x58, \
	0x4e, 0x6c, 0x58, 0x47, 0x59, 0x6f, 0x7a, 0x44, \
	0x0a, 0x39, 0x51, 0x49, 0x44, 0x41, 0x51, 0x41, \
	0x42, 0x0a, 0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x45, \
	0x4e, 0x44, 0x20, 0x50, 0x55, 0x42, 0x4c, 0x49, \
	0x43, 0x20, 0x4b, 0x45, 0x59, 0x2d, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x0a
};


static uint8_t Certificate[1688] = {
	0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, \
	0x49, 0x4e, 0x20, 0x43, 0x45, 0x52, 0x54, 0x49, \
	0x46, 0x49, 0x43, 0x41, 0x54, 0x45, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x2d, 0x0a, 0x4d, 0x49, 0x49, 0x45, \
	0x73, 0x6a, 0x43, 0x43, 0x41, 0x35, 0x71, 0x67, \
	0x41, 0x77, 0x49, 0x42, 0x41, 0x67, 0x49, 0x4a, \
	0x41, 0x4f, 0x61, 0x6b, 0x50, 0x74, 0x32, 0x48, \
	0x38, 0x30, 0x44, 0x44, 0x4d, 0x41, 0x30, 0x47, \
	0x43, 0x53, 0x71, 0x47, 0x53, 0x49, 0x62, 0x33, \
	0x44, 0x51, 0x45, 0x42, 0x43, 0x77, 0x55, 0x41, \
	0x4d, 0x49, 0x47, 0x69, 0x4d, 0x51, 0x73, 0x77, \
	0x43, 0x51, 0x59, 0x44, 0x0a, 0x56, 0x51, 0x51, \
	0x47, 0x45, 0x77, 0x4a, 0x56, 0x55, 0x7a, 0x45, \
	0x53, 0x4d, 0x42, 0x41, 0x47, 0x41, 0x31, 0x55, \
	0x45, 0x43, 0x41, 0x77, 0x4a, 0x54, 0x57, 0x6c, \
	0x75, 0x62, 0x6d, 0x56, 0x7a, 0x62, 0x33, 0x52, \
	0x68, 0x4d, 0x52, 0x41, 0x77, 0x44, 0x67, 0x59, \
	0x44, 0x56, 0x51, 0x51, 0x48, 0x44, 0x41, 0x64, \
	0x43, 0x63, 0x6d, 0x46, 0x75, 0x5a, 0x47, 0x39, \
	0x75, 0x4d, 0x52, 0x59, 0x77, 0x0a, 0x46, 0x41, \
	0x59, 0x44, 0x56, 0x51, 0x51, 0x4b, 0x44, 0x41, \
	0x31, 0x4a, 0x52, 0x47, 0x5a, 0x31, 0x63, 0x32, \
	0x6c, 0x76, 0x62, 0x69, 0x77, 0x67, 0x54, 0x45, \
	0x78, 0x44, 0x4d, 0x52, 0x55, 0x77, 0x45, 0x77, \
	0x59, 0x44, 0x56, 0x51, 0x51, 0x4c, 0x44, 0x41, \
	0x78, 0x43, 0x61, 0x57, 0x63, 0x67, 0x51, 0x32, \
	0x68, 0x70, 0x63, 0x43, 0x42, 0x53, 0x4a, 0x6b, \
	0x51, 0x78, 0x48, 0x6a, 0x41, 0x63, 0x0a, 0x42, \
	0x67, 0x4e, 0x56, 0x42, 0x41, 0x4d, 0x4d, 0x46, \
	0x55, 0x6c, 0x45, 0x5a, 0x6e, 0x56, 0x7a, 0x61, \
	0x57, 0x39, 0x75, 0x49, 0x46, 0x56, 0x75, 0x61, \
	0x58, 0x51, 0x67, 0x56, 0x47, 0x56, 0x7a, 0x64, \
	0x43, 0x42, 0x44, 0x51, 0x54, 0x45, 0x65, 0x4d, \
	0x42, 0x77, 0x47, 0x43, 0x53, 0x71, 0x47, 0x53, \
	0x49, 0x62, 0x33, 0x44, 0x51, 0x45, 0x4a, 0x41, \
	0x52, 0x59, 0x50, 0x5a, 0x33, 0x64, 0x41, 0x0a, \
	0x61, 0x57, 0x52, 0x6d, 0x64, 0x58, 0x4e, 0x70, \
	0x62, 0x32, 0x34, 0x75, 0x62, 0x6d, 0x56, 0x30, \
	0x4d, 0x42, 0x34, 0x58, 0x44, 0x54, 0x45, 0x35, \
	0x4d, 0x54, 0x41, 0x78, 0x4e, 0x6a, 0x41, 0x77, \
	0x4e, 0x44, 0x41, 0x77, 0x4e, 0x31, 0x6f, 0x58, \
	0x44, 0x54, 0x49, 0x35, 0x4d, 0x54, 0x41, 0x78, \
	0x4d, 0x7a, 0x41, 0x77, 0x4e, 0x44, 0x41, 0x77, \
	0x4e, 0x31, 0x6f, 0x77, 0x67, 0x61, 0x73, 0x78, \
	0x0a, 0x43, 0x7a, 0x41, 0x4a, 0x42, 0x67, 0x4e, \
	0x56, 0x42, 0x41, 0x59, 0x54, 0x41, 0x6c, 0x56, \
	0x54, 0x4d, 0x52, 0x49, 0x77, 0x45, 0x41, 0x59, \
	0x44, 0x56, 0x51, 0x51, 0x49, 0x44, 0x41, 0x6c, \
	0x4e, 0x61, 0x57, 0x35, 0x75, 0x5a, 0x58, 0x4e, \
	0x76, 0x64, 0x47, 0x45, 0x78, 0x45, 0x44, 0x41, \
	0x4f, 0x42, 0x67, 0x4e, 0x56, 0x42, 0x41, 0x63, \
	0x4d, 0x42, 0x30, 0x4a, 0x79, 0x59, 0x57, 0x35, \
	0x6b, 0x0a, 0x62, 0x32, 0x34, 0x78, 0x46, 0x6a, \
	0x41, 0x55, 0x42, 0x67, 0x4e, 0x56, 0x42, 0x41, \
	0x6f, 0x4d, 0x44, 0x55, 0x6c, 0x45, 0x5a, 0x6e, \
	0x56, 0x7a, 0x61, 0x57, 0x39, 0x75, 0x4c, 0x43, \
	0x42, 0x4d, 0x54, 0x45, 0x4d, 0x78, 0x46, 0x54, \
	0x41, 0x54, 0x42, 0x67, 0x4e, 0x56, 0x42, 0x41, \
	0x73, 0x4d, 0x44, 0x45, 0x4a, 0x70, 0x5a, 0x79, \
	0x42, 0x44, 0x61, 0x47, 0x6c, 0x77, 0x49, 0x46, \
	0x49, 0x6d, 0x0a, 0x52, 0x44, 0x45, 0x6e, 0x4d, \
	0x43, 0x55, 0x47, 0x41, 0x31, 0x55, 0x45, 0x41, \
	0x77, 0x77, 0x65, 0x53, 0x55, 0x52, 0x6d, 0x64, \
	0x58, 0x4e, 0x70, 0x62, 0x32, 0x34, 0x67, 0x56, \
	0x57, 0x35, 0x70, 0x64, 0x43, 0x42, 0x55, 0x5a, \
	0x58, 0x4e, 0x30, 0x49, 0x45, 0x4e, 0x6c, 0x63, \
	0x6e, 0x52, 0x70, 0x5a, 0x6d, 0x6c, 0x6a, 0x59, \
	0x58, 0x52, 0x6c, 0x4d, 0x52, 0x34, 0x77, 0x48, \
	0x41, 0x59, 0x4a, 0x0a, 0x4b, 0x6f, 0x5a, 0x49, \
	0x68, 0x76, 0x63, 0x4e, 0x41, 0x51, 0x6b, 0x42, \
	0x46, 0x67, 0x39, 0x6e, 0x64, 0x30, 0x42, 0x70, \
	0x5a, 0x47, 0x5a, 0x31, 0x63, 0x32, 0x6c, 0x76, \
	0x62, 0x69, 0x35, 0x75, 0x5a, 0x58, 0x51, 0x77, \
	0x67, 0x67, 0x45, 0x69, 0x4d, 0x41, 0x30, 0x47, \
	0x43, 0x53, 0x71, 0x47, 0x53, 0x49, 0x62, 0x33, \
	0x44, 0x51, 0x45, 0x42, 0x41, 0x51, 0x55, 0x41, \
	0x41, 0x34, 0x49, 0x42, 0x0a, 0x44, 0x77, 0x41, \
	0x77, 0x67, 0x67, 0x45, 0x4b, 0x41, 0x6f, 0x49, \
	0x42, 0x41, 0x51, 0x43, 0x39, 0x61, 0x52, 0x54, \
	0x43, 0x69, 0x56, 0x66, 0x49, 0x33, 0x75, 0x4d, \
	0x54, 0x64, 0x4d, 0x47, 0x4e, 0x6e, 0x75, 0x43, \
	0x77, 0x53, 0x33, 0x56, 0x43, 0x72, 0x2f, 0x33, \
	0x46, 0x2b, 0x77, 0x6b, 0x56, 0x6e, 0x77, 0x37, \
	0x78, 0x4d, 0x45, 0x6f, 0x5a, 0x4f, 0x67, 0x37, \
	0x48, 0x46, 0x6a, 0x7a, 0x4b, 0x0a, 0x59, 0x55, \
	0x64, 0x32, 0x65, 0x30, 0x59, 0x4e, 0x68, 0x49, \
	0x44, 0x55, 0x77, 0x68, 0x32, 0x4c, 0x65, 0x39, \
	0x66, 0x48, 0x4b, 0x6a, 0x35, 0x78, 0x76, 0x31, \
	0x45, 0x35, 0x63, 0x36, 0x72, 0x4f, 0x76, 0x43, \
	0x79, 0x6e, 0x44, 0x7a, 0x30, 0x6e, 0x67, 0x54, \
	0x36, 0x63, 0x66, 0x70, 0x6c, 0x52, 0x36, 0x32, \
	0x50, 0x44, 0x71, 0x6f, 0x55, 0x64, 0x5a, 0x77, \
	0x5a, 0x50, 0x41, 0x72, 0x55, 0x36, 0x0a, 0x55, \
	0x57, 0x35, 0x49, 0x4b, 0x55, 0x58, 0x73, 0x32, \
	0x75, 0x78, 0x34, 0x38, 0x70, 0x4c, 0x73, 0x57, \
	0x49, 0x6c, 0x58, 0x6c, 0x4e, 0x74, 0x30, 0x6a, \
	0x50, 0x71, 0x56, 0x76, 0x6e, 0x66, 0x6c, 0x78, \
	0x67, 0x65, 0x77, 0x7a, 0x6f, 0x79, 0x44, 0x48, \
	0x53, 0x75, 0x48, 0x4e, 0x39, 0x33, 0x6b, 0x46, \
	0x76, 0x2b, 0x64, 0x42, 0x53, 0x5a, 0x33, 0x65, \
	0x62, 0x75, 0x6e, 0x73, 0x55, 0x2b, 0x79, 0x0a, \
	0x30, 0x69, 0x69, 0x59, 0x77, 0x37, 0x4a, 0x64, \
	0x54, 0x48, 0x47, 0x35, 0x37, 0x2b, 0x33, 0x68, \
	0x4d, 0x5a, 0x31, 0x38, 0x47, 0x69, 0x43, 0x71, \
	0x58, 0x4d, 0x68, 0x77, 0x71, 0x72, 0x4b, 0x43, \
	0x66, 0x70, 0x62, 0x44, 0x56, 0x51, 0x7a, 0x78, \
	0x38, 0x6f, 0x43, 0x4e, 0x30, 0x57, 0x4d, 0x78, \
	0x51, 0x4f, 0x4e, 0x4e, 0x6d, 0x41, 0x53, 0x58, \
	0x34, 0x71, 0x4b, 0x31, 0x76, 0x39, 0x34, 0x43, \
	0x0a, 0x53, 0x33, 0x57, 0x4b, 0x4f, 0x6b, 0x44, \
	0x71, 0x6d, 0x6a, 0x58, 0x47, 0x52, 0x69, 0x6d, \
	0x42, 0x35, 0x45, 0x6c, 0x71, 0x4e, 0x51, 0x35, \
	0x50, 0x7a, 0x63, 0x4c, 0x46, 0x77, 0x4f, 0x4f, \
	0x64, 0x57, 0x33, 0x78, 0x33, 0x38, 0x64, 0x6e, \
	0x55, 0x33, 0x4f, 0x38, 0x72, 0x6f, 0x38, 0x73, \
	0x36, 0x55, 0x6b, 0x39, 0x36, 0x73, 0x50, 0x67, \
	0x47, 0x50, 0x57, 0x31, 0x56, 0x6f, 0x4c, 0x6e, \
	0x49, 0x0a, 0x6d, 0x52, 0x59, 0x57, 0x4f, 0x4b, \
	0x34, 0x6f, 0x35, 0x69, 0x52, 0x58, 0x59, 0x66, \
	0x6d, 0x55, 0x55, 0x6e, 0x38, 0x74, 0x75, 0x59, \
	0x77, 0x79, 0x33, 0x4e, 0x63, 0x32, 0x56, 0x63, \
	0x5a, 0x69, 0x6a, 0x4d, 0x50, 0x31, 0x41, 0x67, \
	0x4d, 0x42, 0x41, 0x41, 0x47, 0x6a, 0x67, 0x64, \
	0x38, 0x77, 0x67, 0x64, 0x77, 0x77, 0x67, 0x63, \
	0x45, 0x47, 0x41, 0x31, 0x55, 0x64, 0x49, 0x77, \
	0x53, 0x42, 0x0a, 0x75, 0x54, 0x43, 0x42, 0x74, \
	0x71, 0x47, 0x42, 0x71, 0x4b, 0x53, 0x42, 0x70, \
	0x54, 0x43, 0x42, 0x6f, 0x6a, 0x45, 0x4c, 0x4d, \
	0x41, 0x6b, 0x47, 0x41, 0x31, 0x55, 0x45, 0x42, \
	0x68, 0x4d, 0x43, 0x56, 0x56, 0x4d, 0x78, 0x45, \
	0x6a, 0x41, 0x51, 0x42, 0x67, 0x4e, 0x56, 0x42, \
	0x41, 0x67, 0x4d, 0x43, 0x55, 0x31, 0x70, 0x62, \
	0x6d, 0x35, 0x6c, 0x63, 0x32, 0x39, 0x30, 0x59, \
	0x54, 0x45, 0x51, 0x0a, 0x4d, 0x41, 0x34, 0x47, \
	0x41, 0x31, 0x55, 0x45, 0x42, 0x77, 0x77, 0x48, \
	0x51, 0x6e, 0x4a, 0x68, 0x62, 0x6d, 0x52, 0x76, \
	0x62, 0x6a, 0x45, 0x57, 0x4d, 0x42, 0x51, 0x47, \
	0x41, 0x31, 0x55, 0x45, 0x43, 0x67, 0x77, 0x4e, \
	0x53, 0x55, 0x52, 0x6d, 0x64, 0x58, 0x4e, 0x70, \
	0x62, 0x32, 0x34, 0x73, 0x49, 0x45, 0x78, 0x4d, \
	0x51, 0x7a, 0x45, 0x56, 0x4d, 0x42, 0x4d, 0x47, \
	0x41, 0x31, 0x55, 0x45, 0x0a, 0x43, 0x77, 0x77, \
	0x4d, 0x51, 0x6d, 0x6c, 0x6e, 0x49, 0x45, 0x4e, \
	0x6f, 0x61, 0x58, 0x41, 0x67, 0x55, 0x69, 0x5a, \
	0x45, 0x4d, 0x52, 0x34, 0x77, 0x48, 0x41, 0x59, \
	0x44, 0x56, 0x51, 0x51, 0x44, 0x44, 0x42, 0x56, \
	0x4a, 0x52, 0x47, 0x5a, 0x31, 0x63, 0x32, 0x6c, \
	0x76, 0x62, 0x69, 0x42, 0x56, 0x62, 0x6d, 0x6c, \
	0x30, 0x49, 0x46, 0x52, 0x6c, 0x63, 0x33, 0x51, \
	0x67, 0x51, 0x30, 0x45, 0x78, 0x0a, 0x48, 0x6a, \
	0x41, 0x63, 0x42, 0x67, 0x6b, 0x71, 0x68, 0x6b, \
	0x69, 0x47, 0x39, 0x77, 0x30, 0x42, 0x43, 0x51, \
	0x45, 0x57, 0x44, 0x32, 0x64, 0x33, 0x51, 0x47, \
	0x6c, 0x6b, 0x5a, 0x6e, 0x56, 0x7a, 0x61, 0x57, \
	0x39, 0x75, 0x4c, 0x6d, 0x35, 0x6c, 0x64, 0x49, \
	0x49, 0x4a, 0x41, 0x4e, 0x66, 0x43, 0x66, 0x79, \
	0x57, 0x51, 0x39, 0x78, 0x45, 0x6e, 0x4d, 0x41, \
	0x6b, 0x47, 0x41, 0x31, 0x55, 0x64, 0x0a, 0x45, \
	0x77, 0x51, 0x43, 0x4d, 0x41, 0x41, 0x77, 0x43, \
	0x77, 0x59, 0x44, 0x56, 0x52, 0x30, 0x50, 0x42, \
	0x41, 0x51, 0x44, 0x41, 0x67, 0x62, 0x41, 0x4d, \
	0x41, 0x30, 0x47, 0x43, 0x53, 0x71, 0x47, 0x53, \
	0x49, 0x62, 0x33, 0x44, 0x51, 0x45, 0x42, 0x43, \
	0x77, 0x55, 0x41, 0x41, 0x34, 0x49, 0x42, 0x41, \
	0x51, 0x42, 0x57, 0x33, 0x4d, 0x4b, 0x73, 0x32, \
	0x56, 0x32, 0x59, 0x66, 0x50, 0x72, 0x76, 0x0a, \
	0x72, 0x72, 0x46, 0x52, 0x74, 0x63, 0x73, 0x44, \
	0x66, 0x54, 0x65, 0x74, 0x79, 0x6e, 0x6a, 0x55, \
	0x47, 0x34, 0x39, 0x43, 0x79, 0x79, 0x79, 0x62, \
	0x48, 0x63, 0x55, 0x35, 0x75, 0x62, 0x6f, 0x4f, \
	0x6b, 0x58, 0x43, 0x65, 0x5a, 0x57, 0x55, 0x50, \
	0x57, 0x6a, 0x72, 0x46, 0x2f, 0x44, 0x2f, 0x79, \
	0x61, 0x6d, 0x4d, 0x73, 0x43, 0x6f, 0x41, 0x35, \
	0x6f, 0x32, 0x39, 0x65, 0x31, 0x6c, 0x6b, 0x74, \
	0x0a, 0x42, 0x39, 0x64, 0x37, 0x38, 0x44, 0x54, \
	0x6a, 0x43, 0x6d, 0x39, 0x6e, 0x2b, 0x74, 0x53, \
	0x4a, 0x54, 0x51, 0x4b, 0x6f, 0x6a, 0x46, 0x43, \
	0x6a, 0x38, 0x72, 0x63, 0x65, 0x6f, 0x77, 0x72, \
	0x71, 0x4d, 0x39, 0x69, 0x6e, 0x56, 0x39, 0x48, \
	0x64, 0x55, 0x50, 0x70, 0x32, 0x35, 0x42, 0x49, \
	0x37, 0x30, 0x74, 0x56, 0x73, 0x4a, 0x57, 0x38, \
	0x51, 0x72, 0x41, 0x78, 0x6b, 0x6b, 0x44, 0x6c, \
	0x2f, 0x0a, 0x73, 0x71, 0x43, 0x35, 0x54, 0x7a, \
	0x73, 0x6c, 0x4d, 0x72, 0x65, 0x75, 0x67, 0x4c, \
	0x4c, 0x61, 0x70, 0x64, 0x47, 0x69, 0x36, 0x48, \
	0x6a, 0x56, 0x53, 0x4a, 0x58, 0x65, 0x7a, 0x67, \
	0x4a, 0x47, 0x57, 0x39, 0x56, 0x57, 0x48, 0x4b, \
	0x5a, 0x64, 0x6b, 0x56, 0x39, 0x73, 0x46, 0x52, \
	0x6c, 0x6c, 0x35, 0x48, 0x4c, 0x67, 0x77, 0x6c, \
	0x71, 0x2b, 0x4a, 0x78, 0x51, 0x62, 0x67, 0x58, \
	0x73, 0x71, 0x0a, 0x6a, 0x6c, 0x51, 0x59, 0x4a, \
	0x78, 0x66, 0x41, 0x6d, 0x53, 0x56, 0x6f, 0x50, \
	0x63, 0x30, 0x6b, 0x56, 0x31, 0x35, 0x64, 0x74, \
	0x48, 0x4d, 0x7a, 0x34, 0x52, 0x75, 0x62, 0x74, \
	0x70, 0x66, 0x4e, 0x4b, 0x66, 0x42, 0x62, 0x75, \
	0x62, 0x33, 0x6a, 0x6a, 0x44, 0x35, 0x43, 0x5a, \
	0x4e, 0x49, 0x42, 0x30, 0x44, 0x35, 0x57, 0x2b, \
	0x75, 0x63, 0x59, 0x51, 0x48, 0x6c, 0x69, 0x73, \
	0x4d, 0x6c, 0x33, 0x0a, 0x66, 0x67, 0x61, 0x6e, \
	0x6d, 0x62, 0x5a, 0x39, 0x72, 0x31, 0x5a, 0x54, \
	0x4a, 0x4e, 0x48, 0x4b, 0x79, 0x68, 0x37, 0x64, \
	0x75, 0x4d, 0x62, 0x4d, 0x4a, 0x63, 0x4f, 0x51, \
	0x47, 0x36, 0x4a, 0x35, 0x52, 0x74, 0x4d, 0x34, \
	0x61, 0x5a, 0x35, 0x46, 0x6c, 0x79, 0x7a, 0x65, \
	0x76, 0x2b, 0x56, 0x7a, 0x38, 0x79, 0x49, 0x76, \
	0x2f, 0x77, 0x4c, 0x73, 0x77, 0x61, 0x44, 0x4a, \
	0x47, 0x30, 0x61, 0x61, 0x0a, 0x4c, 0x33, 0x53, \
	0x2b, 0x59, 0x75, 0x62, 0x47, 0x0a, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x2d, 0x45, 0x4e, 0x44, 0x20, 0x43, \
	0x45, 0x52, 0x54, 0x49, 0x46, 0x49, 0x43, 0x41, \
	0x54, 0x45, 0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x0a
};


static uint8_t CAcertificate[1363] = {
	0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, \
	0x49, 0x4e, 0x20, 0x43, 0x45, 0x52, 0x54, 0x49, \
	0x46, 0x49, 0x43, 0x41, 0x54, 0x45, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x2d, 0x0a, 0x4d, 0x49, 0x49, 0x44, \
	0x77, 0x6a, 0x43, 0x43, 0x41, 0x71, 0x6f, 0x43, \
	0x43, 0x51, 0x44, 0x58, 0x77, 0x6e, 0x38, 0x6c, \
	0x6b, 0x50, 0x63, 0x52, 0x4a, 0x7a, 0x41, 0x4e, \
	0x42, 0x67, 0x6b, 0x71, 0x68, 0x6b, 0x69, 0x47, \
	0x39, 0x77, 0x30, 0x42, 0x41, 0x51, 0x73, 0x46, \
	0x41, 0x44, 0x43, 0x42, 0x6f, 0x6a, 0x45, 0x4c, \
	0x4d, 0x41, 0x6b, 0x47, 0x41, 0x31, 0x55, 0x45, \
	0x42, 0x68, 0x4d, 0x43, 0x0a, 0x56, 0x56, 0x4d, \
	0x78, 0x45, 0x6a, 0x41, 0x51, 0x42, 0x67, 0x4e, \
	0x56, 0x42, 0x41, 0x67, 0x4d, 0x43, 0x55, 0x31, \
	0x70, 0x62, 0x6d, 0x35, 0x6c, 0x63, 0x32, 0x39, \
	0x30, 0x59, 0x54, 0x45, 0x51, 0x4d, 0x41, 0x34, \
	0x47, 0x41, 0x31, 0x55, 0x45, 0x42, 0x77, 0x77, \
	0x48, 0x51, 0x6e, 0x4a, 0x68, 0x62, 0x6d, 0x52, \
	0x76, 0x62, 0x6a, 0x45, 0x57, 0x4d, 0x42, 0x51, \
	0x47, 0x41, 0x31, 0x55, 0x45, 0x0a, 0x43, 0x67, \
	0x77, 0x4e, 0x53, 0x55, 0x52, 0x6d, 0x64, 0x58, \
	0x4e, 0x70, 0x62, 0x32, 0x34, 0x73, 0x49, 0x45, \
	0x78, 0x4d, 0x51, 0x7a, 0x45, 0x56, 0x4d, 0x42, \
	0x4d, 0x47, 0x41, 0x31, 0x55, 0x45, 0x43, 0x77, \
	0x77, 0x4d, 0x51, 0x6d, 0x6c, 0x6e, 0x49, 0x45, \
	0x4e, 0x6f, 0x61, 0x58, 0x41, 0x67, 0x55, 0x69, \
	0x5a, 0x45, 0x4d, 0x52, 0x34, 0x77, 0x48, 0x41, \
	0x59, 0x44, 0x56, 0x51, 0x51, 0x44, 0x0a, 0x44, \
	0x42, 0x56, 0x4a, 0x52, 0x47, 0x5a, 0x31, 0x63, \
	0x32, 0x6c, 0x76, 0x62, 0x69, 0x42, 0x56, 0x62, \
	0x6d, 0x6c, 0x30, 0x49, 0x46, 0x52, 0x6c, 0x63, \
	0x33, 0x51, 0x67, 0x51, 0x30, 0x45, 0x78, 0x48, \
	0x6a, 0x41, 0x63, 0x42, 0x67, 0x6b, 0x71, 0x68, \
	0x6b, 0x69, 0x47, 0x39, 0x77, 0x30, 0x42, 0x43, \
	0x51, 0x45, 0x57, 0x44, 0x32, 0x64, 0x33, 0x51, \
	0x47, 0x6c, 0x6b, 0x5a, 0x6e, 0x56, 0x7a, 0x0a, \
	0x61, 0x57, 0x39, 0x75, 0x4c, 0x6d, 0x35, 0x6c, \
	0x64, 0x44, 0x41, 0x65, 0x46, 0x77, 0x30, 0x78, \
	0x4f, 0x54, 0x45, 0x77, 0x4d, 0x54, 0x55, 0x79, \
	0x4d, 0x44, 0x41, 0x34, 0x4d, 0x7a, 0x4e, 0x61, \
	0x46, 0x77, 0x30, 0x79, 0x4d, 0x44, 0x45, 0x77, \
	0x4d, 0x54, 0x51, 0x79, 0x4d, 0x44, 0x41, 0x34, \
	0x4d, 0x7a, 0x4e, 0x61, 0x4d, 0x49, 0x47, 0x69, \
	0x4d, 0x51, 0x73, 0x77, 0x43, 0x51, 0x59, 0x44, \
	0x0a, 0x56, 0x51, 0x51, 0x47, 0x45, 0x77, 0x4a, \
	0x56, 0x55, 0x7a, 0x45, 0x53, 0x4d, 0x42, 0x41, \
	0x47, 0x41, 0x31, 0x55, 0x45, 0x43, 0x41, 0x77, \
	0x4a, 0x54, 0x57, 0x6c, 0x75, 0x62, 0x6d, 0x56, \
	0x7a, 0x62, 0x33, 0x52, 0x68, 0x4d, 0x52, 0x41, \
	0x77, 0x44, 0x67, 0x59, 0x44, 0x56, 0x51, 0x51, \
	0x48, 0x44, 0x41, 0x64, 0x43, 0x63, 0x6d, 0x46, \
	0x75, 0x5a, 0x47, 0x39, 0x75, 0x4d, 0x52, 0x59, \
	0x77, 0x0a, 0x46, 0x41, 0x59, 0x44, 0x56, 0x51, \
	0x51, 0x4b, 0x44, 0x41, 0x31, 0x4a, 0x52, 0x47, \
	0x5a, 0x31, 0x63, 0x32, 0x6c, 0x76, 0x62, 0x69, \
	0x77, 0x67, 0x54, 0x45, 0x78, 0x44, 0x4d, 0x52, \
	0x55, 0x77, 0x45, 0x77, 0x59, 0x44, 0x56, 0x51, \
	0x51, 0x4c, 0x44, 0x41, 0x78, 0x43, 0x61, 0x57, \
	0x63, 0x67, 0x51, 0x32, 0x68, 0x70, 0x63, 0x43, \
	0x42, 0x53, 0x4a, 0x6b, 0x51, 0x78, 0x48, 0x6a, \
	0x41, 0x63, 0x0a, 0x42, 0x67, 0x4e, 0x56, 0x42, \
	0x41, 0x4d, 0x4d, 0x46, 0x55, 0x6c, 0x45, 0x5a, \
	0x6e, 0x56, 0x7a, 0x61, 0x57, 0x39, 0x75, 0x49, \
	0x46, 0x56, 0x75, 0x61, 0x58, 0x51, 0x67, 0x56, \
	0x47, 0x56, 0x7a, 0x64, 0x43, 0x42, 0x44, 0x51, \
	0x54, 0x45, 0x65, 0x4d, 0x42, 0x77, 0x47, 0x43, \
	0x53, 0x71, 0x47, 0x53, 0x49, 0x62, 0x33, 0x44, \
	0x51, 0x45, 0x4a, 0x41, 0x52, 0x59, 0x50, 0x5a, \
	0x33, 0x64, 0x41, 0x0a, 0x61, 0x57, 0x52, 0x6d, \
	0x64, 0x58, 0x4e, 0x70, 0x62, 0x32, 0x34, 0x75, \
	0x62, 0x6d, 0x56, 0x30, 0x4d, 0x49, 0x49, 0x42, \
	0x49, 0x6a, 0x41, 0x4e, 0x42, 0x67, 0x6b, 0x71, \
	0x68, 0x6b, 0x69, 0x47, 0x39, 0x77, 0x30, 0x42, \
	0x41, 0x51, 0x45, 0x46, 0x41, 0x41, 0x4f, 0x43, \
	0x41, 0x51, 0x38, 0x41, 0x4d, 0x49, 0x49, 0x42, \
	0x43, 0x67, 0x4b, 0x43, 0x41, 0x51, 0x45, 0x41, \
	0x76, 0x50, 0x68, 0x53, 0x0a, 0x42, 0x57, 0x65, \
	0x2f, 0x42, 0x72, 0x35, 0x38, 0x38, 0x65, 0x68, \
	0x6e, 0x59, 0x49, 0x63, 0x51, 0x76, 0x73, 0x38, \
	0x55, 0x69, 0x6b, 0x6c, 0x4a, 0x50, 0x34, 0x79, \
	0x37, 0x68, 0x4a, 0x38, 0x33, 0x4e, 0x6e, 0x2f, \
	0x30, 0x39, 0x56, 0x46, 0x74, 0x6f, 0x2b, 0x51, \
	0x74, 0x45, 0x61, 0x5a, 0x4b, 0x2f, 0x66, 0x4b, \
	0x48, 0x4d, 0x32, 0x52, 0x73, 0x39, 0x2f, 0x33, \
	0x2f, 0x4a, 0x6a, 0x2f, 0x69, 0x0a, 0x47, 0x46, \
	0x2b, 0x41, 0x59, 0x62, 0x58, 0x34, 0x5a, 0x4a, \
	0x7a, 0x36, 0x65, 0x4c, 0x41, 0x74, 0x4b, 0x47, \
	0x61, 0x70, 0x32, 0x32, 0x44, 0x49, 0x49, 0x6d, \
	0x42, 0x65, 0x4a, 0x51, 0x2f, 0x42, 0x69, 0x43, \
	0x41, 0x7a, 0x2f, 0x4c, 0x6c, 0x61, 0x30, 0x31, \
	0x6e, 0x32, 0x66, 0x6c, 0x4e, 0x66, 0x65, 0x51, \
	0x6e, 0x34, 0x43, 0x6e, 0x59, 0x76, 0x66, 0x37, \
	0x33, 0x75, 0x6e, 0x46, 0x61, 0x39, 0x0a, 0x33, \
	0x36, 0x6c, 0x66, 0x49, 0x57, 0x77, 0x56, 0x43, \
	0x7a, 0x4d, 0x7a, 0x58, 0x31, 0x41, 0x77, 0x4d, \
	0x34, 0x34, 0x66, 0x4c, 0x55, 0x53, 0x63, 0x4a, \
	0x30, 0x79, 0x49, 0x4a, 0x31, 0x53, 0x39, 0x54, \
	0x58, 0x35, 0x6d, 0x78, 0x5a, 0x4c, 0x4c, 0x4d, \
	0x63, 0x4c, 0x79, 0x6c, 0x4e, 0x36, 0x4f, 0x6d, \
	0x46, 0x71, 0x34, 0x63, 0x63, 0x54, 0x6f, 0x6c, \
	0x55, 0x34, 0x42, 0x4e, 0x63, 0x62, 0x56, 0x0a, \
	0x67, 0x61, 0x4f, 0x69, 0x6e, 0x42, 0x53, 0x72, \
	0x32, 0x6a, 0x4a, 0x37, 0x43, 0x38, 0x53, 0x71, \
	0x43, 0x7a, 0x65, 0x75, 0x50, 0x42, 0x75, 0x6d, \
	0x71, 0x54, 0x64, 0x77, 0x68, 0x56, 0x35, 0x62, \
	0x4c, 0x33, 0x39, 0x41, 0x4d, 0x64, 0x33, 0x65, \
	0x66, 0x36, 0x62, 0x6f, 0x43, 0x47, 0x32, 0x43, \
	0x6b, 0x39, 0x2b, 0x56, 0x45, 0x51, 0x79, 0x2f, \
	0x4b, 0x42, 0x70, 0x45, 0x62, 0x59, 0x6b, 0x56, \
	0x0a, 0x65, 0x36, 0x5a, 0x56, 0x56, 0x32, 0x47, \
	0x52, 0x7a, 0x66, 0x47, 0x54, 0x46, 0x55, 0x73, \
	0x38, 0x78, 0x75, 0x77, 0x61, 0x78, 0x4f, 0x52, \
	0x36, 0x34, 0x31, 0x35, 0x31, 0x67, 0x74, 0x77, \
	0x46, 0x59, 0x72, 0x43, 0x33, 0x7a, 0x6c, 0x77, \
	0x77, 0x4b, 0x33, 0x49, 0x6e, 0x53, 0x5a, 0x69, \
	0x6a, 0x37, 0x41, 0x6b, 0x79, 0x76, 0x6a, 0x68, \
	0x4f, 0x50, 0x74, 0x57, 0x4e, 0x4d, 0x58, 0x36, \
	0x6e, 0x0a, 0x64, 0x2b, 0x41, 0x6e, 0x66, 0x58, \
	0x50, 0x56, 0x4c, 0x7a, 0x6c, 0x65, 0x76, 0x4d, \
	0x4e, 0x5a, 0x4f, 0x51, 0x49, 0x44, 0x41, 0x51, \
	0x41, 0x42, 0x4d, 0x41, 0x30, 0x47, 0x43, 0x53, \
	0x71, 0x47, 0x53, 0x49, 0x62, 0x33, 0x44, 0x51, \
	0x45, 0x42, 0x43, 0x77, 0x55, 0x41, 0x41, 0x34, \
	0x49, 0x42, 0x41, 0x51, 0x41, 0x46, 0x61, 0x58, \
	0x49, 0x7a, 0x79, 0x41, 0x65, 0x72, 0x78, 0x73, \
	0x4d, 0x30, 0x0a, 0x46, 0x38, 0x47, 0x78, 0x31, \
	0x38, 0x68, 0x71, 0x2f, 0x41, 0x6c, 0x52, 0x34, \
	0x2f, 0x49, 0x79, 0x6c, 0x36, 0x64, 0x55, 0x33, \
	0x71, 0x35, 0x6e, 0x68, 0x2b, 0x63, 0x33, 0x6e, \
	0x6d, 0x47, 0x31, 0x4e, 0x62, 0x59, 0x30, 0x4a, \
	0x61, 0x36, 0x37, 0x65, 0x30, 0x41, 0x44, 0x4b, \
	0x5a, 0x66, 0x36, 0x78, 0x76, 0x70, 0x62, 0x6c, \
	0x54, 0x6a, 0x62, 0x76, 0x76, 0x49, 0x79, 0x61, \
	0x44, 0x53, 0x4d, 0x0a, 0x58, 0x4e, 0x51, 0x5a, \
	0x72, 0x37, 0x72, 0x43, 0x61, 0x31, 0x4c, 0x65, \
	0x57, 0x70, 0x66, 0x37, 0x57, 0x32, 0x36, 0x74, \
	0x74, 0x38, 0x73, 0x79, 0x36, 0x74, 0x52, 0x34, \
	0x2b, 0x44, 0x6e, 0x50, 0x41, 0x43, 0x2f, 0x76, \
	0x6d, 0x41, 0x57, 0x63, 0x46, 0x4e, 0x66, 0x45, \
	0x78, 0x70, 0x36, 0x31, 0x6e, 0x5a, 0x59, 0x79, \
	0x72, 0x78, 0x4b, 0x49, 0x2f, 0x4b, 0x70, 0x63, \
	0x2b, 0x44, 0x42, 0x4c, 0x0a, 0x59, 0x52, 0x33, \
	0x67, 0x59, 0x41, 0x4f, 0x45, 0x71, 0x48, 0x41, \
	0x49, 0x31, 0x62, 0x4e, 0x50, 0x30, 0x47, 0x4b, \
	0x75, 0x2f, 0x30, 0x62, 0x41, 0x57, 0x6b, 0x70, \
	0x36, 0x71, 0x67, 0x36, 0x77, 0x6f, 0x73, 0x52, \
	0x43, 0x38, 0x65, 0x59, 0x5a, 0x69, 0x51, 0x6d, \
	0x77, 0x6f, 0x66, 0x49, 0x59, 0x68, 0x75, 0x64, \
	0x64, 0x6b, 0x76, 0x4c, 0x46, 0x30, 0x59, 0x49, \
	0x48, 0x58, 0x79, 0x75, 0x77, 0x0a, 0x39, 0x4c, \
	0x37, 0x2b, 0x61, 0x6f, 0x78, 0x4c, 0x75, 0x39, \
	0x62, 0x68, 0x36, 0x48, 0x44, 0x48, 0x50, 0x75, \
	0x74, 0x45, 0x44, 0x2f, 0x45, 0x45, 0x6b, 0x62, \
	0x31, 0x6b, 0x74, 0x74, 0x68, 0x62, 0x66, 0x38, \
	0x6b, 0x7a, 0x2b, 0x73, 0x4d, 0x31, 0x62, 0x77, \
	0x6e, 0x39, 0x79, 0x44, 0x64, 0x6c, 0x51, 0x77, \
	0x37, 0x66, 0x47, 0x6b, 0x69, 0x4d, 0x4d, 0x46, \
	0x76, 0x4c, 0x79, 0x48, 0x5a, 0x44, 0x0a, 0x46, \
	0x32, 0x7a, 0x57, 0x31, 0x67, 0x63, 0x33, 0x74, \
	0x34, 0x48, 0x68, 0x6f, 0x38, 0x42, 0x31, 0x54, \
	0x63, 0x4c, 0x43, 0x43, 0x4d, 0x50, 0x51, 0x6a, \
	0x51, 0x6a, 0x74, 0x2b, 0x2f, 0x78, 0x34, 0x47, \
	0x44, 0x4c, 0x53, 0x4c, 0x4f, 0x6b, 0x63, 0x4e, \
	0x73, 0x76, 0x4e, 0x74, 0x78, 0x72, 0x63, 0x4d, \
	0x34, 0x50, 0x51, 0x63, 0x71, 0x70, 0x47, 0x38, \
	0x4d, 0x46, 0x45, 0x69, 0x49, 0x4c, 0x63, 0x0a, \
	0x42, 0x37, 0x44, 0x51, 0x75, 0x6e, 0x56, 0x42, \
	0x0a, 0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x45, 0x4e, \
	0x44, 0x20, 0x43, 0x45, 0x52, 0x54, 0x49, 0x46, \
	0x49, 0x43, 0x41, 0x54, 0x45, 0x2d, 0x2d, 0x2d, \
	0x2d, 0x2d, 0x0a
};


static uint8_t Signature[256] = {
	0xb2, 0xa9, 0x78, 0xab, 0xa3, 0xb3, 0x24, 0xa9, \
	0x6d, 0xaa, 0x1c, 0xe3, 0x38, 0xac, 0x5a, 0xf1, \
	0x6a, 0xf7, 0x10, 0x2b, 0xd6, 0x0f, 0xfb, 0x05, \
	0x02, 0x1e, 0x9a, 0x1e, 0x08, 0xe6, 0xaa, 0x50, \
	0x4c, 0x65, 0x5e, 0x7c, 0x2f, 0x18, 0xba, 0xe5, \
	0x55, 0x11, 0x6a, 0x60, 0x52, 0x9e, 0x3d, 0x67, \
	0x6e, 0xa4, 0x24, 0x65, 0xf7, 0xd4, 0x9c, 0x80, \
	0x11, 0xe7, 0xd1, 0x63, 0xe4, 0xac, 0xe7, 0x40, \
	0xa7, 0x7c, 0xea, 0xa7, 0x59, 0xf8, 0x1c, 0x58, \
	0x21, 0x38, 0x0f, 0x86, 0xa1, 0xa4, 0x8e, 0xb6, \
	0xba, 0x8e, 0xa4, 0x1b, 0x8b, 0x3e, 0x4d, 0x4c, \
	0xa5, 0x66, 0x1a, 0xdd, 0x73, 0x35, 0x6c, 0x4f, \
	0x58, 0x6f, 0x9e, 0xb1, 0x31, 0x9b, 0x0b, 0xe3, \
	0xa4, 0x64, 0xc1, 0x34, 0x89, 0xb8, 0x40, 0x33, \
	0x54, 0x97, 0xbf, 0xb4, 0x90, 0x4a, 0x49, 0xe4, \
	0x05, 0x9c, 0x09, 0xd8, 0xdb, 0xea, 0x96, 0x07, \
	0x13, 0xca, 0x88, 0x22, 0x6d, 0x2c, 0xba, 0xc3, \
	0x52, 0xdc, 0xee, 0x0d, 0x8d, 0x3e, 0x83, 0xb9, \
	0x34, 0xda, 0xd8, 0x6b, 0x04, 0xdb, 0x40, 0x6d, \
	0x08, 0xad, 0x7e, 0xf2, 0x8f, 0x12, 0x93, 0x09, \
	0xca, 0xdd, 0x3f, 0x76, 0xc1, 0xf3, 0x22, 0xbf, \
	0x7a, 0x28, 0xf3, 0xf1, 0x73, 0x9c, 0x1d, 0x20, \
	0x93, 0x5e, 0x05, 0xec, 0xbd, 0xa2, 0xc6, 0x06, \
	0xa2, 0xe1, 0x3d, 0x21, 0x57, 0xc5, 0x37, 0x9d, \
	0x5d, 0xd6, 0x86, 0x36, 0xb8, 0xed, 0x82, 0xe5, \
	0x90, 0x3c, 0xc4, 0xd8, 0xb0, 0x11, 0x9e, 0x94, \
	0x79, 0xc1, 0xc4, 0x49, 0x49, 0x3b, 0xc2, 0xdd, \
	0xd8, 0xb6, 0x7e, 0xd9, 0x16, 0x09, 0xae, 0x4a, \
	0x43, 0x4d, 0x66, 0x23, 0xe2, 0xb5, 0x80, 0xb9, \
	0xf1, 0x49, 0x07, 0xbd, 0x5c, 0xa8, 0xf4, 0x12, \
	0x82, 0x24, 0x0a, 0xe2, 0x2d, 0x14, 0xf1, 0x7b, \
	0x51, 0xeb, 0xd7, 0xe6, 0xd2, 0x35, 0x9c, 0xa5  \
};


void test_one()

{
	uint8_t lp;

	size_t len;

	static const unsigned char *input = \
		(const unsigned char *) "abc";

	Buffer bufr = NULL;

	Sha256 sha256 = NULL;


	INIT(HurdLib, Buffer, bufr, ERR(goto done));
	INIT(NAAAIM, Sha256, sha256, ERR(goto done));

	len = strlen((char *) input);
	fputs("Input:\n", stdout);
	for (lp= 0; lp < len; ++lp)
		fprintf(stdout, "%02x", input[lp]);
	fputs("\n\n", stdout);

	if ( !bufr->add(bufr, input, len) )
		ERR(goto done);
	fputs("Buffer:\n", stdout);
	bufr->print(bufr);
	fputc('\n', stdout);
	bufr->hprint(bufr);

	fputc('\n', stdout);
	fputs("SHA256:\n", stdout);
	sha256->add(sha256, bufr);
	if ( !sha256->compute(sha256) )
		ERR(goto done);
	sha256->print(sha256);


 done:
	WHACK(bufr);
	WHACK(sha256)

	return;
}


void test_two()

{
	Buffer b;

	RandomBuffer random = NULL;


	INIT(NAAAIM, RandomBuffer, random, ERR(goto done));
	b = random->get_Buffer(random);

	fputs("8 bytes:\n", stdout);
	if ( !random->generate(random, sizeof(uint64_t)) )
		ERR(goto done);
	b->print(b);

	fputs("18 bytes:\n", stdout);
	if ( !random->generate(random, 18) )
		ERR(goto done);
	b->print(b);

	fputs("32 bytes:\n", stdout);
	if ( !random->generate(random, 32) )
		ERR(goto done);
	b->print(b);


 done:
	WHACK(random);

	return;
}


void test_three(void)

{
	Curve25519 ours	  = NULL,
		   theirs = NULL;

	Buffer b,
	       shared = NULL;


	/* Create the public/private keypairs. */
	INIT(NAAAIM, Curve25519, ours, goto done);
	if ( !ours->generate(ours) )
		goto done;
	fputs("Our public:\n", stdout);
	b = ours->get_public(ours);
	b->print(b);

	INIT(NAAAIM, Curve25519, theirs, goto done);
	if ( !theirs->generate(theirs) )
		goto done;
	fputs("\nTheir public:\n", stdout);
	b = theirs->get_public(theirs);
	b->print(b);


	/* Generate and confirm the shared secrets. */
	INIT(HurdLib, Buffer, shared, goto done);
	if ( !ours->compute(ours, theirs->get_public(theirs), shared) )
		goto done;
	fputs("\nOur key:\n", stdout);
	shared->print(shared);

	shared->reset(shared);
	if ( !theirs->compute(theirs, ours->get_public(ours), shared) )
		goto done;
	fputs("\nTheir key:\n", stdout);
	shared->print(shared);


 done:
	WHACK(ours);
	WHACK(theirs);
	WHACK(shared);

	return;
}


void test_four()

{
	static const unsigned char *input = \
		(const unsigned char *) "Hi There";

	static const char *hkey = "0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b";

	Buffer b,
	       key  = NULL,
	       bufr = NULL;

	SHA256_hmac hmac = NULL;


	/* Setup input buffer. */
	INIT(HurdLib, Buffer, bufr, ERR(goto done));
	if ( !bufr->add(bufr, input, strlen((char *) input)) )
		ERR(goto done);
	fputs("Input:\n", stdout);
	bufr->hprint(bufr);


	/* Setup buffer with key. */
	INIT(HurdLib, Buffer, key,  ERR(goto done));
	if ( !key->add_hexstring(key, hkey) )
		ERR(goto done);
	fputs("\nKey:\n", stdout);
	key->print(key);


	/* Compute the message authentication code. */
	if ( (hmac = NAAAIM_SHA256_hmac_Init(key)) == NULL )
		ERR(goto done);
	hmac->add_Buffer(hmac, bufr);
	if ( !hmac->compute(hmac) )
		ERR(goto done);

	fputc('\n', stdout);
	fputs("SHA256_HMAC:\n", stdout);
	b = hmac->get_Buffer(hmac);
	b->print(b);

	fputs("\nExpected:\n", stdout);
	fputs("198a607eb44bfbc69903a0f1cf2bbdc5ba0aa3f3d9ae3c1c7a3b1696a0b68cf7	\n", stdout);


 done:
	WHACK(key);
	WHACK(bufr);
	WHACK(hmac);

	return;
}


void test_five()

{
	static const unsigned char *input = \
		(const unsigned char *) "The Secret";

	static const char *iv_val  = "0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f",
			  *key_val = "0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a0a";

	Buffer iv   = NULL,
	       key  = NULL,
	       bufr = NULL;

	AES256_cbc encrypt = NULL,
		   decrypt = NULL;


	/* Setup input buffer. */
	INIT(HurdLib, Buffer, bufr, ERR(goto done));
	if ( !bufr->add(bufr, input, strlen((char *) input)) )
		ERR(goto done);
	fputs("Input:\n", stdout);
	bufr->hprint(bufr);


	/* Setup IV and key. */
	INIT(HurdLib, Buffer, iv,  ERR(goto done));
	if ( !iv->add_hexstring(iv, iv_val) )
		ERR(goto done);
	fputs("\nIV:\n", stdout);
	iv->print(iv);

	INIT(HurdLib, Buffer, key, ERR(goto done));
	if ( !key->add_hexstring(key, key_val) )
		ERR(goto done);
	fputs("KEY:\n", stdout);
	key->print(key);


	/* Encrypt the string. */
	if ( (encrypt = NAAAIM_AES256_cbc_Init_encrypt(key, iv)) == NULL )
		ERR(goto done);
	if ( !encrypt->encrypt(encrypt, bufr) )
		ERR(goto done);

	bufr->reset(bufr);
	if ( !bufr->add_Buffer(bufr, encrypt->get_Buffer(encrypt)) )
		ERR(goto done);

	fputc('\n', stdout);
	fputs("Encrypted payload:\n", stdout);
	bufr->print(bufr);


	/* Decrypt the string to confirm invertibility. */
	if ( (decrypt = NAAAIM_AES256_cbc_Init_decrypt(key, iv)) == NULL )
		ERR(goto done);
	if ( !decrypt->decrypt(decrypt, encrypt->get_Buffer(encrypt)) )
		ERR(goto done);

	bufr->reset(bufr);
	if ( !bufr->add_Buffer(bufr, decrypt->get_Buffer(decrypt)) )
		ERR(goto done);

	fputc('\n', stdout);
	fputs("Decrypted payload:\n", stdout);
	bufr->hprint(bufr);


 done:
	WHACK(bufr);
	WHACK(iv);
	WHACK(key);
	WHACK(encrypt);
	WHACK(decrypt);

	return;
}


void test_six()

{
	RandomBuffer rnd = NULL;

	Buffer b,
	       bufr = NULL;

	String ascii = NULL;

	Base64 base64 = NULL;


	/* Create a random buffer to encode. */
	INIT(NAAAIM, RandomBuffer, rnd, ERR(goto done));
	if ( !rnd->generate(rnd, 16) )
		ERR(goto done);

	b = rnd->get_Buffer(rnd);
	fputs("Random buffer:\n", stdout);
	b->print(b);


	/* Encode the random buffer. */
	INIT(HurdLib, String, ascii, ERR(goto done));
	INIT(NAAAIM, Base64, base64, ERR(goto done));

	if ( !base64->encode(base64, b, ascii) )
		ERR(goto done);
	fputs("\nEncoded random buffer:\n", stdout);
	ascii->print(ascii);


	/* Decode the buffer. */
	INIT(HurdLib, Buffer, bufr, ERR(goto done));

	if ( !base64->decode(base64, ascii, bufr) )
		ERR(goto done);
	fputs("\nDecoded random buffer:\n", stdout);
	bufr->print(bufr);


 done:
	WHACK(rnd);
	WHACK(bufr);
	WHACK(ascii);
	WHACK(base64);

	return;
}


void test_seven()

{
	_Bool valid = false;

	RSAkey key = NULL;

	Buffer public  = NULL,
	       private = NULL,
	       payload = NULL;

	const static uint8_t encdata[32] = {			\
		0x70, 0x53, 0x4d, 0x06, 0x62, 0xe1, 0x4b, 0x8e, \
		0xef, 0xc7, 0x9e, 0x02, 0x3d, 0x95, 0xa1, 0x7d, \
		0xcf, 0x79, 0x2b, 0xbc, 0x2d, 0xb6, 0xd8, 0x4d, \
		0x31, 0x88, 0xfb, 0x04, 0xb6, 0xa9, 0x1d, 0xf5  \
	};


	INIT(HurdLib, Buffer, public, ERR(goto done));
	INIT(HurdLib, Buffer, private, ERR(goto done));
	INIT(HurdLib, Buffer, payload, ERR(goto done));

	fputs("Generating 2048 bit RSA key.\n", stdout);
	INIT(NAAAIM, RSAkey, key, ERR(goto done));
	if ( !key->generate_key(key, 2048) )
		ERR(goto done);

	fputs("\nKey components:\n", stdout);
	key->print(key);

	fputs("\nPrivate key in PEM form:\n", stdout);
	key->get_private_key(key, private);
	private->hprint(private);

	fputs("\nPublic key in PEM form:\n", stdout);
	key->get_public_key(key, public);
	public->hprint(public);

	if ( !key->get_modulus(key, payload) )
		ERR(goto done);
	fputs("\nModulus:\n", stdout);
	payload->hprint(payload);

	WHACK(key);
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	if ( !key->load_public(key, public) )
		ERR(goto done);

	payload->reset(payload);
	if ( !payload->add(payload, encdata, sizeof(encdata)) )
		ERR(goto done);
	fputs("\nPayload to be encrypted:\n", stdout);
	payload->hprint(payload);

	if ( !key->encrypt(key, payload) )
		ERR(goto done);
	fputs("\nPayload encrypted with public key:\n", stdout);
	payload->hprint(payload);

	WHACK(key);
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	if ( !key->load_private(key, private) )
		ERR(goto done);
	if ( !key->decrypt(key, payload) )
		ERR(goto done);

	fputs("\nPayload decrypted with private key:\n", stdout);
	payload->hprint(payload);


	if ( !key->encrypt(key, payload) )
		ERR(goto done);
	fputs("\nPayload encrypted with private key:\n", stdout);
	payload->hprint(payload);

	WHACK(key);
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	if ( !key->load_public(key, public) )
		ERR(goto done);
	if ( !key->decrypt(key, payload) )
		ERR(goto done);

	fputs("\nPayload decrypted with public key:\n", stdout);
	payload->hprint(payload);


	/* Test loading of a key from a certificate. */
	WHACK(key);
	key = NULL;
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	public->reset(public);
	if ( !public->add(public, Certificate, sizeof(Certificate)) )
		ERR(goto done);
	fputs("\nCertificate:\n", stdout);
	public->hprint(public);

	if ( !key->load_certificate(key, public) )
		ERR(goto done);

	payload->reset(payload);
	if ( !payload->add(payload, Signature, sizeof(Signature)) )
		ERR(goto done);

	if ( !key->verify(key, payload, public, &valid) )
		ERR(goto done);

	fputs("\nSignature:\n", stdout);
	payload->hprint(payload);

	fprintf(stdout, "\nSignature status: %s\n", valid ? "OK" : "INVALID");


	/* Test signature verification with a public key. */
	WHACK(key);
	key = NULL;
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	public->reset(public);
	if ( !public->add(public, PublicKey, sizeof(PublicKey)) )
		ERR(goto done);

	if ( !key->load_public(key, public) )
		ERR(goto done);

	public->reset(public);
	if ( !public->add(public, Certificate, sizeof(Certificate)) )
		ERR(goto done);

	payload->reset(payload);
	if ( !payload->add(payload, Signature, sizeof(Signature)) )
		ERR(goto done);

	if ( !key->verify(key, payload, public, &valid) )
		ERR(goto done);

	fprintf(stdout, "\nPublic key signature status: %s\n", \
		valid ? "OK" : "INVALID");


	/* Test key signing. */
	WHACK(key);
	key = NULL;
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	private->reset(private);
	if ( !private->add(private, Key, sizeof(Key)) )
		ERR(goto done);
	if ( !key->load_private(key, private) )
		ERR(goto done);

	private->reset(private);
	if ( !private->add(private, Certificate, sizeof(Certificate)) )
		ERR(goto done);

	payload->reset(payload);
	if ( !key->sign(key, private, payload) )
		ERR(goto done);

	fputs("\nPrivate key signature:\n", stdout);
	payload->hprint(payload);

	WHACK(key);
	key = NULL;
	INIT(NAAAIM, RSAkey, key, ERR(goto done));

	public->reset(public);
	if ( !public->add(public, PublicKey, sizeof(PublicKey)) )
		ERR(goto done);
	if ( !key->load_public(key, public) )
		ERR(goto done);

	if ( !key->verify(key, payload, private, &valid) )
		ERR(goto done);

	fprintf(stdout, "\nPrivate key signature status: %s\n", \
		valid ? "OK" : "INVALID");


 done:
	WHACK(key);

	WHACK(public);
	WHACK(private);
	WHACK(payload);

	return;
}


void test_eight()

{
	static unsigned char id[32] = {
		0x37, 0x34, 0xd3, 0xa8, 0x52, 0xa0, 0x95, 0x87, \
		0x50, 0xe5, 0x8a, 0xb3, 0xb0, 0xa6, 0x38, 0x5e, \
		0xc9, 0xca, 0x6c, 0x64, 0x40, 0xc4, 0x2c, 0xf8, \
		0x47, 0x61, 0x51, 0x4e, 0x1c, 0x5e, 0xd7, 0x56  \
	};

	Buffer kreq  = NULL,
	       iv    = NULL,
	       key   = NULL;

	SEALkey sealkey = NULL;


	INIT(HurdLib, Buffer, iv, ERR(goto done));
	INIT(HurdLib, Buffer, key, ERR(goto done));
	INIT(NAAAIM, SEALkey, sealkey, ERR(goto done));

	if ( !sealkey->generate_mrsigner(sealkey) )
		ERR(goto done);
	sealkey->print(sealkey);

	if ( !sealkey->get_iv_key(sealkey, iv, key) )
		ERR(goto done);
	fputs("Unshrouded key:\n", stdout);
	key->hprint(key);


	/* Retrieve the key request components. */
	INIT(HurdLib, Buffer, kreq,  ERR(goto done));

	if ( !sealkey->get_request(sealkey, kreq) )
		ERR(goto done);
	fputs("\nRe-generating key on DER encoded key request:\n", stdout);
	kreq->hprint(kreq);


	/* Test re-generation of the key. */
	sealkey->reset(sealkey);
	if ( !sealkey->set_request(sealkey, kreq) )
		ERR(goto done);

	if ( !sealkey->generate_mrsigner(sealkey) )
		ERR(goto done);

	fputs("\n", stdout);
	sealkey->print(sealkey);

	iv->reset(iv);
	key->reset(key);
	if ( !sealkey->get_iv_key(sealkey, iv, key) )
		ERR(goto done);

	fputs("Unshrouded key:\n", stdout);
	key->hprint(key);


	/* Test a re-generatable key. */
	key->reset(key);
	sealkey->reset(sealkey);

	if ( !key->add(key, id, sizeof(id)) )
		ERR(goto done);
	if ( !sealkey->generate_static_key(sealkey, 1 /* SIGNER KEY*/, key) )
		ERR(goto done);

	iv->reset(iv);
	key->reset(key);
	if ( !sealkey->get_iv_key(sealkey, iv, key) )
		ERR(goto done);

	fputs("\nStatic key:\n", stdout);
	key->hprint(key);


 done:
	WHACK(kreq);
	WHACK(iv);
	WHACK(key);
	WHACK(sealkey);

	return;
}


void test_nine()

{
	Buffer bufr = NULL;

	SEALEDblob blob = NULL;

	const unsigned char msg[] = {
		0xfe, 0xad, 0xbe, 0xaf, 0x00, 0xde, 0xad, 0xbe, 0xaf
	};


	INIT(HurdLib, Buffer, bufr, ERR(goto done));
	if ( !bufr->add(bufr, msg, sizeof(msg)) )
		ERR(goto done);

	fputs("Payload:\n", stdout);
	bufr->hprint(bufr);


	INIT(NAAAIM, SEALEDblob, blob, ERR(goto done));
	if ( !blob->add_Buffer(blob, bufr) )
		ERR(goto done);
	if ( !blob->seal(blob) )
		ERR(goto done);

	bufr->reset(bufr);
	if ( !blob->get_Buffer(blob, bufr) )
		ERR(goto done);

	fputs("\nSealed payload:\n", stdout);
	bufr->hprint(bufr);


	WHACK(blob);
	INIT(NAAAIM, SEALEDblob, blob, ERR(goto done));

	if ( !blob->add_Buffer(blob, bufr) )
		ERR(goto done);
	if ( !blob->unseal(blob) )
		ERR(goto done);

	bufr->reset(bufr);
	if ( !blob->get_Buffer(blob, bufr) )
		ERR(goto done);
	fputs("\nUnsealed payload:\n", stdout);
	bufr->hprint(bufr);


 done:
	WHACK(bufr);
	WHACK(blob);

	return;
}


void test_ten()

{
	_Bool valid = false;

	Buffer ca	   = NULL,
	       certificate = NULL;

	X509cert cert = NULL;


	/* Setup the verification chain. */
	fputs("Loading CA certificate.\n", stdout);
	INIT(HurdLib, Buffer, ca, ERR(goto done));
	if ( !ca->add(ca, CAcertificate, sizeof(CAcertificate)) )
		ERR(goto done);

	fputs("Loading standard certificate.\n", stdout);
	INIT(HurdLib, Buffer, certificate, ERR(goto done));
	if ( !certificate->add(certificate, Certificate, sizeof(Certificate)) )
		ERR(goto done);

	INIT(NAAAIM, X509cert, cert, ERR(goto done));
	if ( !cert->add(cert, ca) )
		ERR(goto done);

	fputs("Verifying certificate with no time check.\n", stdout);
	cert->time_check(cert, false);
	if ( !cert->verify(cert, certificate, &valid) )
		ERR(goto done);
	fprintf(stdout, "Certificate status: %s\n", valid ? "OK" : "INVALID");

	fputs("\nSwapping certificates to force failure.\n", stdout);
	ca->reset(ca);
	if ( !ca->add(ca, Certificate, sizeof(Certificate)) )
		ERR(goto done);

	certificate->reset(certificate);
	if ( !certificate->add(certificate, CAcertificate, \
			       sizeof(CAcertificate)) )
		ERR(goto done);

	WHACK(cert);
	INIT(NAAAIM, X509cert, cert, ERR(goto done));
	if ( !cert->add(cert, ca) )
		ERR(goto done);

	cert->time_check(cert, false);
	if ( !cert->verify(cert, certificate, &valid) )
		ERR(goto done);
	fprintf(stdout, "Certificate status: %s\n", valid ? "OK" : "INVALID");


 done:
	WHACK(ca);
	WHACK(certificate);
	WHACK(cert);

	return;
}


void test_passphrase(void)

{
	_Bool pwdfail = false;

	String prompt  = NULL,
	       vprompt = NULL,
	       phrase  = NULL;

	Prompt pwd = NULL;


	INIT(HurdLib, String, prompt, ERR(goto done));
	if ( !prompt->add(prompt, "Passphrase: ") )
		ERR(goto done);

	INIT(HurdLib, String, vprompt, ERR(goto done));
	if ( !vprompt->add(vprompt, "Verify - ") )
		ERR(goto done);

	INIT(HurdLib, String, phrase, ERR(goto done));

	INIT(NAAAIM, Prompt, pwd, ERR(goto done));
	if ( !pwd->get(pwd, prompt, vprompt, 32, phrase, &pwdfail) )
		ERR(goto done);

	fputs("Passphrase: ", stdout);
	phrase->print(phrase);


 done:
	WHACK(prompt);
	WHACK(vprompt);
	WHACK(phrase);
	WHACK(pwd);

	return;
}


void test_naaaim(unsigned int test)

{

	fprintf(stdout, "Test number: %u\n", test);
	switch ( test ) {
		case 1:
			test_one();
			break;
		case 2:
			test_two();
			break;
		case 3:
			test_three();
			break;
		case 4:
			test_four();
			break;
		case 5:
			test_five();
			break;
		case 6:
			test_six();
			break;
		case 7:
			test_seven();
			break;
		case 8:
			test_eight();
			break;
		case 9:
			test_nine();
			break;
		case 10:
			test_ten();
			break;
		case 100:
			test_passphrase();
			break;

		default:
			fputs("Invalid test.\n", stderr);
			break;
	}
	fprintf(stdout, "End test: %d\n", test);


	return;
}
